colnames(lengthtab) <- c("", "")
lengthtab[1:5, 1] <- c("Minimum", "25th percentile", "Median", "75th percentile", "Maximum")
lengthtab[1:5, 2] <- round(fivenum(pex$ep_length), 4)
kable(lengthtab)
over30days <- pex[pex$ep_length >= 30, c(which(colnames(pex) == "cffidno"),
which(colnames(pex) == "ep_length"))]
over30days <- over30days[is.na(over30days$ep_length) == F, ]
colnames(over30days) <- c("Patient ID", "Episode Length (days)")
test <- as.data.frame(table(over30days$cffidno))
length(unique(over30days$`Patient ID`))
names(test)
View(test)
test <- as.data.frame(table(over30days$`Patient ID`))
View(test)
colnames(test) <- c("cffidno", "Freq")
library(knitr)
pex_alldata <- read.csv("C:/Users/johnsra3/Documents/Thesis/DataRaw/Episode.csv", header = T)
pex <- pex_alldata[pex_alldata$rsn_pe == 1, ]
pex$StartAge_day <- pex$StartAge * 365
pex$EndAge_day <- pex$EndAge * 365
pex <- pex[, -which(colnames(pex) == "StartAge")]
pex <- pex[, -which(colnames(pex) == "EndAge")]
pex <- pex[, -which(colnames(pex) == "rsn_pe")]
pex <- pex[, -which(colnames(pex) == "ce_meas_age_begin")]
pex <- pex[, -which(colnames(pex) == "ce_meas_age_end")]
lengthbt <- matrix(data = NA, nrow = nrow(pex), ncol = 2)
lengthbt[1, 2] <- NA
pex <- pex[order(pex$cffidno), ]
for(i in 2:nrow(pex)){
lengthbt[i, 1] <- pex$cffidno[i]
if(identical(pex$cffidno[i], pex$cffidno[i-1])){
lengthbt[i, 2] <- pex$StartAge_day[i] - pex$EndAge_day[i-1]
} else {
lengthbt[i, 2] <- NA
}
}
lengthbt <- as.data.frame(lengthbt)
colnames(lengthbt) <- c("cffidno1", "lengthbtpex")
pex_gr0 <- cbind.data.frame(pex, lengthbt)
pex_gr0 <- pex_gr0[, -which(colnames(pex_gr0) == "cffidno1")]
pex <- pex_gr0
rm(pex_gr0)
pex$ident <- NA
for(i in 2:nrow(pex)){
if(identical(pex$cffidno[i-1], pex$cffidno[i])){
pex$ident[i] <- 1
} else {
pex$ident[i] <- 0
}
}
pex$lessthan7 <- ifelse(pex$lengthbtpex <= 7, 1, 0)
pex$combined <- NA
compare_test <- pex
for(i in 2:nrow(pex)){
if(pex$ident[i] == 1 & pex$lessthan7[i] == 1 & !is.na(pex$lessthan7[i])){
pex$EndAge_day[i-1] <- pex$EndAge_day[i]
pex$ce_fvc_end[i-1] <- pex$ce_fvc_end[i]
pex$ce_fev1_end[i-1] <- pex$ce_fev1_end[i]
pex$ce_fef25_end[i-1] <- pex$ce_fef25_end[i]
pex$combined[i] <- 1
} else {
pex$combined[i] <- 0
}
}
pex <- pex[pex$combined != 1, ]
lengthbt_new <- matrix(data = NA, nrow = nrow(pex), ncol = 2)
lengthbt_new[1, 2] <- NA
pex <- pex[order(pex$cffidno), ]
for(i in 2:nrow(pex)){
lengthbt_new[i, 1] <- pex$cffidno[i]
if(identical(pex$cffidno[i], pex$cffidno[i-1])){
lengthbt_new[i, 2] <- pex$StartAge_day[i] - pex$EndAge_day[i-1]
} else {
lengthbt_new[i, 2] <- NA
}
}
lengthbt_new <- as.data.frame(lengthbt_new)
colnames(lengthbt_new) <- c("cffidno1", "lengthbtpex")
pex <- pex[, -which(colnames(pex) == "lengthbtpex")]
pex <- pex[, -which(colnames(pex) == "lessthan7")]
pex <- pex[, -which(colnames(pex) == "ident")]
pex <- pex[, -which(colnames(pex) == "combined")]
pex_new <- cbind.data.frame(pex, lengthbt_new)
pex_new <- pex_new[, -which(colnames(pex_new) == "cffidno1")]
pex <- pex_new
rm(pex_new)
pex$diff_fvc <- pex$ce_fvc_end - pex$ce_fvc_begin
pex$diff_fev1 <- pex$ce_fev1_end - pex$ce_fev1_begin
pex$diff_fef25 <- pex$ce_fef25_end - pex$ce_fef25_begin
pex$ep_length <- pex$EndAge_day - pex$StartAge_day
pex$ce_fef25_begin[pex$ce_fef25_begin == 0] <- NA
pex$ce_fev1_begin[pex$ce_fev1_begin == 0] <- NA
pex$ce_fvc_begin[pex$ce_fvc_begin == 0] <- NA
age_0 <- pex[which(pex$StartAge_day == 0), ]
lengthtab <- matrix(data = NA, nrow = 5, ncol = 2)
colnames(lengthtab) <- c("", "")
lengthtab[1:5, 1] <- c("Minimum", "25th percentile", "Median", "75th percentile", "Maximum")
lengthtab[1:5, 2] <- round(fivenum(pex$ep_length), 4)
kable(lengthtab)
over30days <- pex[pex$ep_length >= 30, c(which(colnames(pex) == "cffidno"),
which(colnames(pex) == "ep_length"))]
over30days <- over30days[is.na(over30days$ep_length) == F, ]
colnames(over30days) <- c("Patient ID", "Episode Length (days)")
test <- as.data.frame(table(over30days$`Patient ID`))
colnames(test) <- c("cffidno", "Freq")
names(over309)
names(over30days)
names(over30days)
over30days$`Patient ID`
unique(over30days$`Patient ID`)
length(unique(over30days$`Patient ID`))
min(test$Freq)
max(test$Freq)
mean(test$Freq)
median(test$Freq)
install.packages("nlme")
?lme
library(nlme)
?lme
mean <- 0
var <- 1000
sd <- sqrt(var)
x <- seq(-4,4,length=1000)*sd + mean
hx <- dnorm(x,mean,sd)
plot(hx)
plot(hx ~ x)
plot(hx ~ x, pch = ".")
abline(h = -83.2590)
abline(x = -83.2590)
abline(v = -83.2590)
abline(v = -81.7680)
sqrt(43560)
sqrt(304920)
library(knitr)
library(data.table)
setwd("//proton/EJCgroupStudentThesesJohnsonR/Data/DataSource")
enroll <- read.csv("Enrollment.csv", header = T)
epicenc <- read.csv("Epic_Encounters.csv", header = T)
regenc <- read.csv("Reg_Encounters.csv", header = T)
setwd("//proton/EJCgroupStudentThesesJohnsonR/Data/DataCreated")
pex_alldata <- read.csv("C:/Users/johnsra3/Documents/Thesis/DataRaw/Episode.csv", header = T)
pex <- pex_alldata[pex_alldata$rsn_pe == 1, ]
pex$StartAge_day <- pex$StartAge * 365
pex$EndAge_day <- pex$EndAge * 365
pex <- pex[, -which(colnames(pex) == "StartAge")]
pex <- pex[, -which(colnames(pex) == "EndAge")]
pex <- pex[, -which(colnames(pex) == "rsn_pe")]
pex <- pex[, -which(colnames(pex) == "ce_meas_age_begin")]
pex <- pex[, -which(colnames(pex) == "ce_meas_age_end")]
lengthbt <- matrix(data = NA, nrow = nrow(pex), ncol = 2)
lengthbt[1, 2] <- NA
pex <- pex[order(pex$cffidno), ]
for(i in 2:nrow(pex)){
lengthbt[i, 1] <- pex$cffidno[i]
if(identical(pex$cffidno[i], pex$cffidno[i-1])){
lengthbt[i, 2] <- pex$StartAge_day[i] - pex$EndAge_day[i-1]
} else {
lengthbt[i, 2] <- NA
}
}
lengthbt <- as.data.frame(lengthbt)
colnames(lengthbt) <- c("cffidno1", "lengthbtpex")
pex_gr0 <- cbind.data.frame(pex, lengthbt)
pex_gr0 <- pex_gr0[, -which(colnames(pex_gr0) == "cffidno1")]
pex <- pex_gr0
rm(pex_gr0)
pex$ident <- NA
for(i in 2:nrow(pex)){
if(identical(pex$cffidno[i-1], pex$cffidno[i])){
pex$ident[i] <- 1
} else {
pex$ident[i] <- 0
}
}
pex$lessthan7 <- ifelse(pex$lengthbtpex <= 7, 1, 0)
pex$combined <- NA
compare_test <- pex
for(i in 2:nrow(pex)){
if(pex$ident[i] == 1 & pex$lessthan7[i] == 1 & !is.na(pex$lessthan7[i])){
pex$EndAge_day[i-1] <- pex$EndAge_day[i]
pex$ce_fvc_end[i-1] <- pex$ce_fvc_end[i]
pex$ce_fev1_end[i-1] <- pex$ce_fev1_end[i]
pex$ce_fef25_end[i-1] <- pex$ce_fef25_end[i]
pex$combined[i] <- 1
} else {
pex$combined[i] <- 0
}
}
pex <- pex[pex$combined != 1, ]
lengthbt_new <- matrix(data = NA, nrow = nrow(pex), ncol = 2)
lengthbt_new[1, 2] <- NA
pex <- pex[order(pex$cffidno), ]
for(i in 2:nrow(pex)){
lengthbt_new[i, 1] <- pex$cffidno[i]
if(identical(pex$cffidno[i], pex$cffidno[i-1])){
lengthbt_new[i, 2] <- pex$StartAge_day[i] - pex$EndAge_day[i-1]
} else {
lengthbt_new[i, 2] <- NA
}
}
lengthbt_new <- as.data.frame(lengthbt_new)
colnames(lengthbt_new) <- c("cffidno1", "lengthbtpex")
pex <- pex[, -which(colnames(pex) == "lengthbtpex")]
pex <- pex[, -which(colnames(pex) == "lessthan7")]
pex <- pex[, -which(colnames(pex) == "ident")]
pex <- pex[, -which(colnames(pex) == "combined")]
pex_new <- cbind.data.frame(pex, lengthbt_new)
pex_new <- pex_new[, -which(colnames(pex_new) == "cffidno1")]
pex <- pex_new
rm(pex_new)
pex$diff_fvc <- pex$ce_fvc_end - pex$ce_fvc_begin
pex$diff_fev1 <- pex$ce_fev1_end - pex$ce_fev1_begin
pex$diff_fef25 <- pex$ce_fef25_end - pex$ce_fef25_begin
pex$ep_length <- pex$EndAge_day - pex$StartAge_day
pex$ce_fef25_begin[pex$ce_fef25_begin == 0] <- NA
pex$ce_fev1_begin[pex$ce_fev1_begin == 0] <- NA
pex$ce_fvc_begin[pex$ce_fvc_begin == 0] <- NA
age_0 <- pex[which(pex$StartAge_day == 0), ]
#############
age_initial <- cbind.data.frame(enroll$cffidno, enroll$ConsentAge)
age_initial <- age_initial[order(age_initial$`enroll$cffidno`), ]
colnames(age_initial) <- c("cffidno", "ConsentAge")
regenc_ages <- regenc[ , c(which(colnames(regenc) == "cffidno"), which(colnames(regenc) == "VisitAge"))]
regenc_ages <- as.data.table(regenc_ages)
regenc_ages <- setDT(regenc_ages)[, .SD[which.max(VisitAge)], by = cffidno]
regenc_ages$source <- "registry"
epicenc_ages <- epicenc[, c(which(colnames(epicenc) == "cffidno"), which(colnames(epicenc) == "VisitAge"))]
epicenc_ages <- as.data.table(epicenc_ages)
epicenc_ages <- setDT(epicenc_ages)[, .SD[which.max(VisitAge)], by = cffidno]
epicenc_ages$source <- "epic"
endages <- rbind.data.frame(regenc_ages, epicenc_ages)
endages <- as.data.table(endages)
endages <- setDT(endages)[, .SD[which.max(VisitAge)], by = cffidno]
age_initial <- age_initial[order(age_initial$cffidno), ]
endages <- endages[order(endages$cffidno), ]
ages <- merge(age_initial, endages, by = "cffidno")
colnames(ages)[3] <- "LastVisitAge"
#Create follow-up variable
ages$followup <- ages$LastVisitAge - ages$ConsentAge
pex <- pex[pex$ep_length < 300, ]
hist(pex$ep_length, breaks = 30, main = "Histogram of Lengths of\nClinically Defined Episodes",
xlab = "Length of Episode (days)")
lengthtab <- matrix(data = NA, nrow = 5, ncol = 2)
colnames(lengthtab) <- c("", "")
lengthtab[1:5, 1] <- c("Minimum", "25th percentile", "Median", "75th percentile", "Maximum")
lengthtab[1:5, 2] <- round(fivenum(pex$ep_length), 4)
kable(lengthtab)
setwd("//proton/EJCgroupStudentThesesJohnsonR/Data/DataCreated")
freqpex <- read.csv("NumPexPerIndiv.csv", header = T)
freqpex <- freqpex[, -1]
freqpex <- merge(freqpex, ages, by = "cffidno")
mean(freqpex$followup)
mean(freqpex$Freq)
var(freqpex$Freq)
10350 * .20
10350 * .20 * 0.75
345 * .2
1552.5/69
365/14
14/365
e <- exp(1)
e^-1.1
library(knitr)
library(pscl)
library(MASS)
setwd("//proton/EJCgroupStudentThesesJohnsonR/Data/DataCreated")
pex <- read.csv("PExDataCleaned.csv", header = T)
enroll <- read.csv("EnrollmentCleaned.csv", header = T)
ages <- read.csv("FollowUpTimes.csv", header = T)
freqpex <- read.csv("NumPexPerIndiv.csv", header = T)
freqpex <- freqpex[, -1]
freqpex <- merge(freqpex, ages, by = "cffidno")
setwd("//proton/EJCgroupStudentThesesJohnsonR/Data/DataSource")
demog <- read.csv("DemographicsCleaned.csv", header = T)
demogfreqpex <- merge(demog, freqpex, by = "cffidno")
demogfreqpex$sex <- factor(demogfreqpex$sex, levels = c("F", "M"))
tab <- matrix(data = NA, nrow = 3, ncol = 4)
colnames(tab) <- c("", "Start of Episode (mean (sd))", "End of Episode (mean (sd))",
"Difference (mean (sd))")
tab[1:3, 1] <- c("FVC", "FEV1", "FEF25-75")
tab[1, 2] <- paste(round(mean(pex$ce_fvc_begin, na.rm = T), 2), paste("(",
round(sd(pex$ce_fvc_begin, na.rm = T), 2), ")", sep = ""))
tab[1, 3] <- paste(round(mean(pex$ce_fvc_end, na.rm = T), 2), paste("(",
round(sd(pex$ce_fvc_end, na.rm = T), 2), ")", sep = ""))
tab[1, 4] <- paste(round(mean(pex$diff_fvc, na.rm = T), 2), paste("(",
round(sd(pex$diff_fvc, na.rm = T), 2), ")", sep = ""))
tab[2, 2] <- paste(round(mean(pex$ce_fev1_begin, na.rm = T), 2), paste("(",
round(sd(pex$ce_fev1_begin, na.rm = T), 2), ")", sep = ""))
tab[2, 3] <- paste(round(mean(pex$ce_fev1_end, na.rm = T), 2), paste("(",
round(sd(pex$ce_fev1_end, na.rm = T), 2), ")", sep = ""))
tab[2, 4] <- paste(round(mean(pex$diff_fev1, na.rm = T), 2), paste("(",
round(sd(pex$diff_fev1, na.rm = T), 2), ")", sep = ""))
tab[3, 2] <- paste(round(mean(pex$ce_fef25_begin, na.rm = T), 2), paste("(",
round(sd(pex$ce_fef25_begin, na.rm = T), 2), ")", sep = ""))
tab[3, 3] <- paste(round(mean(pex$ce_fef25_end, na.rm = T), 2), paste("(",
round(sd(pex$ce_fef25_end, na.rm = T), 2), ")", sep = ""))
tab[3, 4]<- paste(round(mean(pex$diff_fef25, na.rm = T), 2), paste("(",
round(sd(pex$diff_fef25, na.rm = T), 2), ")", sep = ""))
kable(tab)
hist(pex$ep_length, breaks = 30, main = "Histogram of Lengths of\nClinically Defined Episodes",
xlab = "Length of Episode (days)")
lengthtab <- matrix(data = NA, nrow = 5, ncol = 2)
colnames(lengthtab) <- c("", "")
lengthtab[1:5, 1] <- c("Minimum", "25th percentile", "Median", "75th percentile", "Maximum")
lengthtab[1:5, 2] <- round(fivenum(pex$ep_length), 4)
kable(lengthtab)
hist(pex$lengthbtpex, xlab = "Time between Episodes (days)",
main = "Length of Time Between\nClinically Defined Pulmonary Exacerbations", breaks = 25)
bttab <- matrix(data = NA, nrow = 5, ncol = 2)
colnames(bttab) <- c("", "")
bttab[1:5, 1] <- c("Minimum", "25th percentile", "Median", "75th percentile", "Maximum")
bttab[1:5, 2] <- round(fivenum(pex$lengthbtpex), 4)
kable(bttab)
hist(ages$ConsentAge, xlab = "Consent age (years)", main =
"Consent Age of Study Participants", breaks = 20)
contab <- matrix(data = NA, nrow = 5, ncol = 2)
colnames(contab) <- c("", "")
contab[1:5, 1] <- c("Minimum", "25th percentile", "Median", "75th percentile", "Maximum")
contab[1:5, 2] <- round(fivenum(ages$ConsentAge), 4)
kable(contab)
hist(ages$max_age, xlab = "Age at most recent visit (years)", main =
"Age of Study Participants\nat Most Recent Observation", breaks = 20)
vistab <- matrix(data = NA, nrow = 5, ncol = 2)
colnames(vistab) <- c("", "")
vistab[1:5, 1] <- c("Minimum", "25th percentile", "Median", "75th percentile", "Maximum")
vistab[1:5, 2] <- round(fivenum(ages$max_age), 4)
kable(vistab)
hist(ages$followup, xlab = "Length of follow-up (years)", main =
"Length of Follow-up\nof Study Participants", breaks = 20)
foltab <- matrix(data = NA, nrow = 5, ncol = 2)
colnames(foltab) <- c("", "")
foltab[1:5, 1] <- c("Minimum", "25th percentile", "Median", "75th percentile", "Maximum")
foltab[1:5, 2] <- round(fivenum(ages$followup), 4)
kable(foltab)
no_pex <- enroll[!enroll$cffidno %in% pex$cffidno, ]
freqID <- as.data.frame(table(pex$cffidno))
freqID$cats <- NA
freqID$cats <- ifelse(freqID$Freq >= 5, "5+", freqID$Freq)
fpextab <- matrix(data = NA, nrow = 6, ncol = 3)
colnames(fpextab) <- c("Number of exacerbations", "n", "%")
fpextab[1:6, 1] <- c("0", "1", "2", "3", "4", "5+")
fpextab[1, 2] <- nrow(no_pex)
fpextab[2:6, 2] <- table(freqID$cats)
fpextab[1:6, 3] <- round(as.numeric(fpextab[, 2])/nrow(enroll) * 100, 2)
kable(fpextab)
futab <- matrix(data = NA, nrow = 6, ncol = 3)
colnames(futab) <- c("", "No Exacerbations", "At Least One Exacerbation")
no <- freqpex[freqpex$Freq == 0, ]
more <- freqpex[freqpex$Freq > 0, ]
futab[1:6, 1] <- c("Minimum", "25th percentile", "Median", "Mean", "75th percentile", "Maximum")
futab[1:3, 2] <- round(fivenum(no$followup)[1:3], 2)
futab[4, 2] <- round(mean(no$followup), 2)
futab[5:6, 2] <- round(fivenum(no$followup)[4:5], 2)
futab[1:3, 3] <- round(fivenum(more$followup)[1:3], 2)
futab[4, 3] <- round(mean(more$followup), 2)
futab[5:6, 3] <- round(fivenum(more$followup)[4:5], 2)
kable(futab)
hist(freqpex$Freq, xlab = "Number of exacerbations", ylab = "Frequency",
main = "Number of Exacerbations per Person", breaks = 20)
plot(freqpex$Freq ~ freqpex$followup, xlab = "Follow-up time (years)", ylab = "Number of Exacerbations",
main = "Number of Exacerbations per\nYear of Follow-up Time")
pex_less60 <- which(pex$ep_length >= 60)
rem_ids <- pex$cffidno[pex_less60]
rem_sites <- pex$siteid[pex_less60]
pex_test <- pex[!pex$cffidno %in% rem_ids, ]
hist(pex_test$ep_length, xlab = "Episode length (days)", ylab = "Frequency",
main = "Distribution of Episode Lengths if only \nIndividual with Episodes Less than 60 days are Included")
fit1 <- glm(Freq ~ offset(log(followup)), data = freqpex, family = poisson(link = log))
summary(fit1)
fit2 <- zeroinfl(Freq ~ offset(log(followup)), data = freqpex)
summary(fit2)
fit3 <- glm.nb(Freq ~ offset(log(followup)), data = freqpex)
summary(fit3)
fit4 <- glm(Freq ~ ConsentAge + sex + ConsentAge*sex + offset(log(followup)), data = demogfreqpex, family = poisson(link = log))
summary(fit4)
fit5 <- zeroinfl(Freq ~ ConsentAge + sex + ConsentAge*sex + offset(log(followup)), data = demogfreqpex)
summary(fit5)
fit6 <- glm.nb(Freq ~ ConsentAge + sex + ConsentAge*sex + offset(log(followup)), data = demogfreqpex)
summary(fit6)
fit4_nointrxn <- glm(Freq ~ ConsentAge + sex + offset(log(followup)), data = demogfreqpex, family = poisson(link = log))
summary(fit4_nointrxn)
fit5_nointrxn <- zeroinfl(Freq ~ ConsentAge + sex + offset(log(followup)), data = demogfreqpex)
summary(fit5_nointrxn)
fit6_nointrxn <- glm.nb(Freq ~ ConsentAge + sex + offset(log(followup)), data = demogfreqpex)
summary(fit6_nointrxn)
AIC(fit1)
AIC(fit2)
AIC(fit3)
AIC(fit4)
AIC(fit5)
AIC(fit6)
AIC(fit4_nointrxn)
AIC(fit5_nointrxn)
AIC(fit6_nointrxn)
summary(fit6_nointrxn)$coefficients
e <- exp(1)
#int
int <- round(e^summary(fit6_nointrxn)$coefficients[1, 1], 3)
int_CIlow <- round(e^(summary(fit6_nointrxn)$coefficients[1, 1] - 1.96 * summary(fit6_nointrxn)$coefficients[1, 2]), 3)
int_CIhigh <- round(e^(summary(fit6_nointrxn)$coefficients[1, 1] + 1.96 * summary(fit6_nointrxn)$coefficients[1, 2]), 3)
int_p <- round(summary(fit6_nointrxn)$coefficients[1, 4], 3)
#age (continuous)
age <- round(e^summary(fit6_nointrxn)$coefficients[2, 1], 3)
age_CIlow <- round(e^(summary(fit6_nointrxn)$coefficients[2, 1] - 1.96 * summary(fit6_nointrxn)$coefficients[2, 2]), 3)
age_CIhigh <- round(e^(summary(fit6_nointrxn)$coefficients[2, 1] + 1.96 * summary(fit6_nointrxn)$coefficients[2, 2]), 3)
age_p <- round(summary(fit6_nointrxn)$coefficients[2, 4], 3)
#sex (reference = F)
sex <- round(e^summary(fit6_nointrxn)$coefficients[3, 1], 3)
sex_CIlow <- round(e^(summary(fit6_nointrxn)$coefficients[3, 1] - 1.96 * summary(fit6_nointrxn)$coefficients[3, 2]), 3)
sex_CIhigh <- round(e^(summary(fit6_nointrxn)$coefficients[3, 1] + 1.96 * summary(fit6_nointrxn)$coefficients[3, 2]), 3)
sex_p <- round(summary(fit6_nointrxn)$coefficients[3, 4], 3)
(int <- round(e^summary(fit6_nointrxn)$coefficients[1, 1], 3))
(int_CIlow <- round(e^(summary(fit6_nointrxn)$coefficients[1, 1] - 1.96 * summary(fit6_nointrxn)$coefficients[1, 2]), 3))
(int_CIhigh <- round(e^(summary(fit6_nointrxn)$coefficients[1, 1] + 1.96 * summary(fit6_nointrxn)$coefficients[1, 2]), 3))
(int_p <- round(summary(fit6_nointrxn)$coefficients[1, 4], 3))
library(dplyr)
setwd("~/School/AdvancedData")
vadata <- read.csv("VadataCleaned.csv", header = T)
comp <- vadata[, c(1, 2, 3, 4, 8, 10, 11)]
comp <- comp[complete.cases(comp), ]
comp_39 <- comp[comp$sixmonth == 39, ]
excl <- vadata[, c(1, 2, 3, 4, 8, 10, 11)]
excl <- excl[!excl$X %in% comp$X, ]
excl_39 <- excl[excl$sixmonth == 39, ]
table(comp_39$death30, excl_39$death30)
vadata$complete <- ifelse(vadata$X %in% comp$X, 1, 0)
pd39 <- vadata[vadata$sixmonth == 39, ]
table(pd39$death30, pd39$complete)
chisq.test(pd39$death30)
chisq.test(pd39$death30, pd39$complete)
t.test(pd39$death30 ~ pd39$complete)
chisq.test(pd39$complete, pd39$death30)
table(is.na(vadata$albumin) == T)
alb_miss <- vadata[is.na(vadata$albumin) == T, ]
alb_pres <- vadata[is.na(vadata$albumin) == F, ]
nrow(alb_miss)/nrow(vadtaa)
nrow(alb_miss)/nrow(vadata)
hist(vadata$albumin)
mean(vadata$albumin)
mean(vadata$albumin, na.rm = T)
setwd("~/School/AdvancedData")
vadata <- read.csv("VadataCleaned.csv", header = T)
rec <- vadata[vadata$sixmonth == 39, ]
old <- vadata[vadata$sixmonth != 39, ]
vadata$asa <- factor(vadata$asa, levels = c("3 or less", "4 or greater"))
tabdata <- vadata
tabdata <- tabdata[, -c(which(colnames(tabdata) == "weight"),
which(colnames(tabdata) == "height"),
which(colnames(tabdata) == "sixmonth"))]
names(tabdata)
rows <- 1 + 1 + 3 + 3 + 2 + 3 + 1
tab <- matrix(data = NA, nrow = rows, ncol = 2)
colnames(tab) <- c("", "")
tab[1, 1] <- "Hospitals (n)"
tab[1, 2] <- length(unique(tabdata$hospcode))
tab[2, 1] <- "Patients undergoing heart surgery (n)"
tab[2, 2] <- nrow(tabdata)
tab[3, 1] <- "Procedure (n (%))"
tab[4:5, 1] <- c("Valve surgery", "CABG surgery")
tab[4, 2] <- paste(nrow(tabdata[tabdata$proced == 0, ]), paste("(",
round(nrow(tabdata[tabdata$proced == 0, ])/nrow(tabdata) * 100, 2), ")", sep = ""))
tab[5, 2] <- paste(nrow(tabdata[tabdata$proced == 1, ]), paste("(",
round(nrow(tabdata[tabdata$proced == 1, ])/nrow(tabdata) * 100, 2), ")", sep = ""))
tab[6, 1] <- "ASA (n (%))"
tab[7:9, 1] <- c("3 or less", "4 or greater", "Missing")
tab[7, 2] <- paste(nrow(tabdata[tabdata$asa == "3 or less" & is.na(tabdata$asa) == F, ]), paste("(",
round(nrow(tabdata[tabdata$asa == "3 or less" & is.na(tabdata$asa) == F, ])/nrow(tabdata) * 100, 2), ")", sep = ""))
tab[8, 2] <- paste(nrow(tabdata[tabdata$asa == "4 or greater" & is.na(tabdata$asa) == F, ]), paste("(",
round(nrow(tabdata[tabdata$asa == "4 or greater" & is.na(tabdata$asa) == F, ])/nrow(tabdata) * 100, 2), ")", sep = ""))
tab[9, 2] <- paste(nrow(tabdata[is.na(tabdata$asa) == T, ]), paste("(",
round(nrow(tabdata[is.na(tabdata$asa) == T, ])/nrow(tabdata) * 100, 2), ")", sep = ""))
tabdata <- vadata
tabdata <- tabdata[, -c(which(colnames(tabdata) == "weight"),
which(colnames(tabdata) == "height"),
which(colnames(tabdata) == "sixmonth"))]
names(tabdata)
rows <- 1 + 1 + 3 + 3 + 2 + 3 + 1
tab <- matrix(data = NA, nrow = rows, ncol = 2)
colnames(tab) <- c("", "")
tab[1, 1] <- "Hospitals (n)"
tab[1, 2] <- length(unique(tabdata$hospcode))
tab[2, 1] <- "Patients undergoing heart surgery (n)"
tab[2, 2] <- nrow(tabdata)
tab[3, 1] <- "Procedure (n (%))"
tab[4:5, 1] <- c("Valve surgery", "CABG surgery")
tab[4, 2] <- paste(nrow(tabdata[tabdata$proced == 0, ]), paste("(",
round(nrow(tabdata[tabdata$proced == 0, ])/nrow(tabdata) * 100, 2), ")", sep = ""))
tab[5, 2] <- paste(nrow(tabdata[tabdata$proced == 1, ]), paste("(",
round(nrow(tabdata[tabdata$proced == 1, ])/nrow(tabdata) * 100, 2), ")", sep = ""))
tab[6, 1] <- "ASA (n (%))"
tab[7:9, 1] <- c("3 or less", "4 or greater", "Missing")
tab[7, 2] <- paste(nrow(tabdata[tabdata$asa == "3 or less" & is.na(tabdata$asa) == F, ]), paste("(",
round(nrow(tabdata[tabdata$asa == "3 or less" & is.na(tabdata$asa) == F, ])/nrow(tabdata) * 100, 2), ")", sep = ""))
tab[8, 2] <- paste(nrow(tabdata[tabdata$asa == "4 or greater" & is.na(tabdata$asa) == F, ]), paste("(",
round(nrow(tabdata[tabdata$asa == "4 or greater" & is.na(tabdata$asa) == F, ])/nrow(tabdata) * 100, 2), ")", sep = ""))
tab[9, 2] <- paste(nrow(tabdata[is.na(tabdata$asa) == T, ]), paste("(",
round(nrow(tabdata[is.na(tabdata$asa) == T, ])/nrow(tabdata) * 100, 2), ")", sep = ""))
tab[10:11, 1] <- c("BMI (mean (SD))", "Missing (n (%))")
tab[10, 2] <- paste(round(mean(tabdata$bmi, na.rm = T), 2), paste("(",
round(sd(tabdata$bmi, na.rm = T), 2), ")", sep = ""))
tab[11, 2] <- paste(nrow(tabdata[is.na(tabdata$bmi) == T, ]), paste("(",
round(nrow(tabdata[is.na(tabdata$bmi) == T, ])/nrow(tabdata) * 100, 2), ")", sep = ""))
tab[12:13, 1] <- c("Albumin (mean (SD))", "Missing (n (%))")
tab[12, 2] <- paste(round(mean(tabdata$albumin, na.rm = T), 2), paste("(",
round(sd(tabdata$albumin, na.rm = T), 2), ")", sep = ""))
tab[13, 2] <- paste(nrow(tabdata[is.na(tabdata$albumin) == T, ]), paste("(",
round(nrow(tabdata[is.na(tabdata$albumin) == T, ])/nrow(tabdata) * 100, 2), ")", sep = ""))
tab[14, 1] <- "30 day mortality (n (%))"
tab[14, 2] <- paste(nrow(tabdata[tabdata$death30 == 1 & is.na(tabdata$asa) == F, ]), paste("(",
round(nrow(tabdata[tabdata$death30 == 1 & is.na(tabdata$asa) == F, ])/nrow(tabdata) * 100, 2), ")", sep = ""))
setwd("C:/Repositories/bios6623-johnsra3/Project2/Reports")
write.csv(tab, "TableOverallCharacteristics.csv")
