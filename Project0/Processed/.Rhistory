install.packages("powerMediation")
library(powerMediation)
setwd("~/School/AdvancedData")
gums <- read.csv("Project0_dental_data.csv", header = T)
#=================================================================#
# Explore all variables indiv. (even though randomized trial)
#=================================================================#
names(gums)
table(gums$id) #no repeat IDs
table(gums$trtgroup) #evenly spread; 26 in each group
table(gums$trtgroup) #not an even number of men and women
table(gums$sex, gums$trtgroup) #however there are approx. equal in each group
table(gums$race) #definitely uneven numbers
table(gums$age)
gums$age <- as.numeric(gums$age)
summary(gums$age)
table(gums$smoker, gums$trtgroup)
summary(gums$sites)
summary(gums$attachbase)
boxplot(gums$attachbase)
summary(gums$attach1year)
boxplot(gums$attach1year)
gums$diffattach <- gums$attach1year - gums$attachbase
summary(gums$diffattach)
boxplot(gums$diffattach)
summary(gums$pdbase)
boxplot(gums$pdbase)
summary(gums$pd1year)
boxplot(gums$pd1year)
gums$diffpd <- gums$pd1year - gums$pdbase
summary(gums$diffpd)
boxplot(gums$diffpd)
#=================================================================#
# Label variables from data dictionary
#=================================================================#
labels <- gums
names(labels)
table(labels$trtgroup)
labels$trtgroup <- factor(labels$trtgroup, levels = c("1", "2", "3", "4", "5"),
labels = c("Placebo", "Control", "Low Dose",
"Medium Dose", "High Dose"))
table(labels$sex)
labels$sex <- factor(labels$sex, levels = c("1", "2"), labels =
c("Male", "Female"))
table(labels$race)
labels$race <- factor(labels$race, levels = c("1", "2", "4", "5"),
labels = c("Native American", "African American",
"Asian", "White"))
table(labels$smoker)
labels$smoker <- factor(labels$smoker, levels = c("0", "1"), labels = c("No", "Yes"))
#=================================================================#
# Investigate missing data for outcome
#=================================================================#
missing <- gums[is.na(gums$pd1year) == TRUE, ]
table(missing$sex)
table(missing$race)
summary(missing$age)
table(missing$smoker)
#None of these contain unusual patterns that would explain missingness
#Since they're missing the outcomes, they will be excluded from the analysis
#therefore, will exclude them from dataset now
labels <- labels[is.na(labels$pd1year) == FALSE, ]
gums <- gums[is.na(gums$pd1year) == FALSE, ]
model1_data <- gums[, c("id", "trtgroup", "attachbase", "attach1year", "diffattach")]
model1_data$trtgroup <- factor(model1_data$trtgroup, levels = c("2", "1", "3", "4", "5"))
model1 <- lm(diffattach ~ trtgroup + attachbase, data = model1_data)
summary(model1)
#Model 2
model2_data <- gums[, c("id", "trtgroup", "pdbase", "pd1year", "diffpd")]
model2_data$trtgroup <- factor(model2_data$trtgroup, levels = c("2", "1", "3", "4", "5"))
model2 <- lm(diffpd ~ trtgroup + pdbase, data = model2_data)
summary(model2)
setwd("C:/Repositories/bios6623-johnsra3/Project0/Processed")
write.csv(model1tab, "Model1_Attachment_AnalysisTable.csv")
model1res <- summary(model1)$coef[, -3]
model1res <- round(model1res, 3)
rownames(model1res) <- c("Intercept (Control)", "Placebo", "Low Dose",
"Medium Dose", "High Dose", "Baseline Attachment")
model1res <- as.data.frame(model1res)
model1res$CI <- round(model1res$`Std. Error` * 1.96, 3)
model1res$CIlow <- model1res$Estimate - model1res$CI
model1res$CIhigh <- model1res$Estimate + model1res$CI
model1res$CIfull <- paste("(", model1res$CIlow, ",", model1res$CIhigh, ")")
model1tab <- model1res[, c(1, 7, 3)]
colnames(model1tab) <- c("Estimate", "95% Confidence Interval", "p-value")
write.csv(model1tab, "Model1_Attachment_AnalysisTable.csv")
model2res <- summary(model2)$coef[, -3]
model2res <- round(model2res, 3)
rownames(model2res) <- c("Intercept (Control)", "Placebo", "Low Dose",
"Medium Dose", "High Dose", "Baseline Attachment")
model2res <- as.data.frame(model2res)
model2res$CI <- round(model2res$`Std. Error` * 1.96, 3)
model2res$CIlow <- model2res$Estimate - model2res$CI
model2res$CIhigh <- model2res$Estimate + model2res$CI
model2res$CIfull <- paste("(", model2res$CIlow, ",", model2res$CIhigh, ")")
model2tab <- model2res[, c(1, 7, 3)]
colnames(model2tab) <- c("Estimate", "95% Confidence Interval", "p-value")
setwd("C:/Repositories/bios6623-johnsra3/Project0/Processed")
write.csv(model2tab, "Model2_PocketDepth_AnalysisTable.csv")
